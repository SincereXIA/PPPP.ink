---
title: 1 应用程序与基本执行环境
date: 2021-06-08T12:59:06.273Z
publish: false
---

## 应用程序执行环境

在现代操作系统之上的应用程序，需要下面一套多层次的执行环境栈：

![2021-07-21-1626835725-4RQ6mv](https://static.sumblog.cn/Pic/2021-07-21-1626835725-4RQ6mv.jpg)

总的执行环境栈：**函数库、内核、指令集**

> - 如果函数库和内核都不存在，那么我们就是在手写汇编代码，这种方式具有最高的灵活性，抽象能力则最低，基本等同于硬件。我们通常用这种方式来实现一些架构相关且仅通过编程语言无法描述的小模块或者代码片段。
> - 如果仅存在函数库而不存在内核，意味着我们不需要内核提供的抽象。在嵌入式场景就常常会出现这种情况。嵌入式设备虽然也包含 CPU、内存和 I/O 设备，但是它上面通常只会同时运行一个或几个功能非常简单的小应用程序，其定位就是那种功能单一的场景，比如人脸识别打卡系统等。我们常用的操作系统如 Windows/Linux/macOS 等的抽象都支持同时运行很多应用程序，在嵌入式场景是过抽象或功能太多，用力过猛的。因此，常见的解决方案是**仅使用函数库构建单独的应用程序或是用专为应用场景特别裁减过的轻量级内核管理少数应用程序**。

### 平台 目标三元组

平台是指：CPU 指令集、操作系统、运行时标准库
目标三元组：用来描述目标平台，一般包括 CPU 架构、CPU 厂商、操作系统和运行时库。

> 例如：`riscv64gc-unknown-none-elf`，目标三元组中的 CPU 架构是 riscv64gc，厂商是 unknown，操作系统是 none，elf表示没有标准的运行时库（表明没有任何系统调用的封装支持），但可以生成ELF格式的执行程序。
> 例如：`x86_64-unknown-linux-gnu` CPU 架构是 x86_64，CPU 厂商是 unknown，操作系统是 linux，运行时库是gnu libc（封装了Linux系统调用，并提供POSIX接口为主的函数库）。